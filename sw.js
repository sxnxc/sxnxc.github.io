!function(){"use strict";const e="0VMZYpdgCGL3iKAzDHwocTt97e1hasO2mJNjExq4PvR6XyWSFbIn-5B_8fUukQlr",t=e.split(""),i=new Array(123);for(let t=0;t<e.length;t++)i[e.charCodeAt(t)]=t;const s=e=>{if(e<0)return`-${s(-e)}`;let i=e>>>0,n=e/4294967296>>>0,a="";for(;n>0;)a=t[63&i]+a,i>>>=6,i|=(63&n)<<26,n>>>=6;let r="";do{r=t[63&i]+r,i>>>=6}while(i>0);return r+a};var n={ntob:s,bton:e=>{let t=0;for(let s=0;s<e.length;s++)t=64*t+i[e.charCodeAt(s)];return t}};let a,r,l=(()=>{let e,t=new Promise((t=>e=t)),i=!1;return{complete:t=>{e(t),i=!0},join:()=>t,completed:()=>i,reset:()=>{t=new Promise((t=>e=t)),i=!1}}})();caches.open("c-vv").then((e=>l.complete(e)));let c=["/","/index.html","/manifest.json","/favicon.ico","https://cdn.jsdelivr.net/npm/zlibjs@0.3.1/bin/rawdeflate.min.js","https://cdn.jsdelivr.net/npm/zlibjs@0.3.1/bin/rawinflate.min.js"];function o(e){return e&&!e.redirected&&200==e.status&&Number(e.headers.get("content-length"))>0&&e.headers.get("content-type").includes("image")}function d(e){return new Promise((t=>setTimeout(t,Math.random()*e)))}async function u(e,t,i=!1,s=0,n){try{let a;if(0===s)a=e;else if(s>0)a=e.replace("_360.",`_${s}.`);else if(s<0){a=e.replace("/files-tmb/","/files-pri/").replace("_360.",".");let t=a.split("/files-pri/")[1].split("/")[0].split("-")[2];if(a=a.replace("-"+t,""),n){let e=a.split("/").pop();a=a.replace(e,n)}}return i&&(a+="?"+Math.floor(10*Math.random())+1),await fetch("https://slack.us.workers.dev/?"+a,{headers:{"x-cors-headers":JSON.stringify({Authorization:"Bearer "+t})}})}catch(e){return}}self.addEventListener("install",(e=>{self.skipWaiting(),e.waitUntil((async()=>{let e=await l.join();await e.addAll(c)})())})),self.addEventListener("fetch",(e=>{e.respondWith((async()=>{if(await l.join(),!(e.request.url.includes("dist/0.js")||e.request.url.includes("dist/s.js")||e.request.url.includes("style.css")||e.request.url.includes("livereload"))){let t=await caches.match(e.request);if(t&&200==t.status&&t.body)return t}r||(r=await caches.open("o-vv"));try{if(a&&"GET"===e.request.method&&e.request.url.startsWith("https://files.slack.com")){const t=e.request.url.indexOf("?");let i=e.request.url.substr(t+1).split("&"),s=i[0],n=i[1];const l=e.request.url.slice(0,t),c=a[s].token;let f=await u(l,c);for(let e=0;e<3&&!o(f);e++)await d(100),f=await u(l,c,!0);for(let e=0;e<3&&!o(f);e++)await d(5e3),f=await u(l,c,e>0,-1,n);return o(f)||(await d(100),f=await u(l,c,!0,480)),o(f)||(await d(100),f=await u(l,c,!0,720)),o(f)&&r.put(e.request,f.clone()),f}const t=await fetch(e.request,{referrerPolicy:"no-referrer"});return"GET"===e.request.method&&200==t.status&&t.body&&r.put(e.request,t.clone()),t}catch(t){return r.match(e.request)}})())})),self.addEventListener("notificationclick",(e=>{const t=e.notification,i=e.action,{chanid:s}=t.data;"close"===i?t.close():"open"===i?clients.openWindow(`/#${n.ntob(s)}`):(clients.openWindow(`/#${n.ntob(s)}`),t.close())})),self.addEventListener("message",(({data:e})=>{a=e})),self.addEventListener("push",(e=>{const{title:t,txt:i,chatid:s,chanid:n,by:a}=e.data.json();e.waitUntil(self.registration.showNotification(t,{body:i,tag:n,icon:"/icon-256.png",vibrate:[100,50,100],data:{chatid:s,chanid:n,by:a},requireInteraction:!1,actions:[{action:"open",title:"open message"}]}))})),self.addEventListener("activate",(async e=>{clients.claim(),e.waitUntil((async()=>{let e=await caches.keys();return Promise.all(e.filter((e=>"c-vv"!==e&&"o-vv"!==e)).map((e=>caches.delete(e))))})()),clients.matchAll().then((e=>{e.forEach((e=>e.postMessage({reload:!0})))}))}))}();
